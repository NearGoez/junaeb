import asyncio 
import time
import aiohttp
from bs4 import BeautifulSoup as bs

async def main():
    async with aiohttp.ClientSession() as session:
        async with session.get('https://sinabweb.junaeb.cl/sinabweb/registro', ssl=False) as response:
            html = await response.text()

        soup = bs(html, 'html.parser')
        token = soup.find('input', {'name': '_csrf'})['value']

        headers = {
        'x-csrf-token': token,
        }

        url_personal_info = 'https://sinabweb.junaeb.cl/sinabweb/registro/getPersonaInfo' 

        payload = {
                'rut': '21967064-8',
                }
        async with session.post(url_personal_info, data=payload, headers=headers, ssl=False) as response:
            personal_info_json = await response.text()

        print(personal_info_json)

asyncio.run(main())

            


